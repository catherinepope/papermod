{{/* Shortcode to display apps grouped by type with collapsible sections */}}

{{ $apps := .Site.Data.apps }}

{{/* Collect all unique types */}}
{{ $allTypes := slice }}
{{ range $apps }}
  {{ range .subject }}
    {{ $allTypes = $allTypes | append . }}
  {{ end }}
{{ end }}
{{ $uniqueTypes := $allTypes | uniq }}

<div class="apps-list">
  {{ range $category := $uniqueTypes }}
    <details class="app-category">
      <summary class="category-title">
        <h3>{{ $category }}</h3>
        <span class="toggle-icon">â–¼</span>
      </summary>
      
      <div class="apps-in-category">
        {{ range $key, $app := $apps }}
          {{ if in $app.subject $category }}
            <div class="app-item">
              <h4 class="app-title">
                <a href="{{ $app.url }}" target="_blank" rel="noopener">{{ $app.title }}</a>
              </h4>
              <p class="app-description">{{ $app.description }}</p>
            </div>
          {{ end }}
        {{ end }}
      </div>
    </details>
  {{ end }}
</div>
